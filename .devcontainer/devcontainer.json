{
  "name": "Three.js Development",
  "build": {
    "dockerfile": "Dockerfile",
    "context": ".."
  },

  // Restrict container's filesystem access to only the workspace
  "workspaceMount": "source=${localWorkspaceFolder},target=/workspace,type=bind,consistency=cached",
  "workspaceFolder": "/workspace",

  // Set *default* container specific settings.json values on container create.
  "settings": {
    "editor.formatOnSave": true,
    "editor.defaultFormatter": "esbenp.prettier-vscode",
    "editor.codeActionsOnSave": {
      "source.fixAll.eslint": true
    },
    "terminal.integrated.defaultProfile.linux": "fish",
    "terminal.integrated.profiles.linux": {
      "fish": {
        "path": "/usr/bin/fish"
      }
    }
  },

  // Add the IDs of VS Code extensions you want installed
  "extensions": [
    "ms-azuretools.vscode-docker",
    "dbaeumer.vscode-eslint",
    "esbenp.prettier-vscode"
  ],

  // Forward ports for development server and other services
  "forwardPorts": [3000, 5173],
  "portsAttributes": {
    "3000": {
      "label": "Vite Dev Server",
      "onAutoForward": "notify"
    },
    "5173": {
      "label": "Alternative Vite Port",
      "onAutoForward": "notify"
    }
  },

  // Use 'postCreateCommand' to run commands after the container is created
  "postCreateCommand": "npm install",
  
  // Run gcloud auth and set Claude configuration when container starts
  "postStartCommand": "gcloud auth application-default login && claude config set --global env '{\"CLAUDE_CODE_USE_VERTEX\": \"true\", \"ANTHROPIC_MODEL\": \"claude-3-7-sonnet@20250219\"}'",

  // Configure environment variables
  "remoteEnv": {
    "NODE_ENV": "development",
    "CLAUDE_CODE_USE_VERTEX": "1",
    "CLOUD_ML_REGION": "us-east5",
    "ANTHROPIC_VERTEX_PROJECT_ID": "sc-claude-code-prod"
  },

  // Comment out to connect as root instead. More info: https://aka.ms/vscode-remote/containers/non-root.
  "remoteUser": "node"

  // Uncomment when using a ptrace-based debugger like C++, Go, and Rust
  // "runArgs": [ "--cap-add=SYS_PTRACE", "--security-opt", "seccomp=unconfined" ],

  // Lifecycle scripts to customize container setup
  // "initializeCommand": {
  //   "Prepare workspace": "mkdir -p ${localWorkspaceFolder}/.vscode-server/extensions"
  // }
}
